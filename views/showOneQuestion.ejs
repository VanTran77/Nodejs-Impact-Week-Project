<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <link rel="stylesheet" href="/style.css">
        <title><%- pageTitle %></title>
    </head>
  
<body>
  <%- include("./components/nav") %>
  <!-- <a href=""><img src="bin.png" alt=""></a> -->
  <a href="/questions" class="btn btn-info">Back</a>
  <div class="showOneContainer">
    <div class="card" id="cardShowOne">
      <div class="card-body content">
        <h3 class="titleShowOne card-title"><%= result.question %></h3>
        <p class="card-textOneQuestion"><%= result.description %></p>
        <div class="created-info-showOne">
          <p><strong>Created by: </strong><%= result.user_id.username %></p>
          <p><strong>Created date: </strong><%= result.createdAt.toLocaleDateString() %></p>
           <!-- input & submit answer -->
        <form action="/addAnswer/<%= result._id%>" method="POST">
          <input type="text" id="fieldAnswer" name="answer" placeholder="Enter answer">
          <button class="btn btn-success btn-sm answerButton">Answer</button>
        </form>
        <!-- Display answer -->
        <%# if(answer.length > 0){ %>
            <%# answer.forEach (value => { %>
              <div class="showAnswer">
                <p style="color:green; font-style: italic;"><strong>Answer by:</strong> <%# value.user_id.username %></p>
                <p><%# value.answer %></p>
                <div class="createInfo-btn">
                  <div>
                    <p style="font-style: italic; font-size: 10px; margin-bottom: 1px;"><strong>Created at: </strong> <%# moment(value.createdAt).format('MMMM Do YYYY, h:mm a') %></p>
                    <p style="font-style: italic; font-size: 10px;"><strong>Updated at:</strong> <%# moment(value.updatedAt).format('MMMM Do YYYY, h:mm a') %></p>
                  </div>
                  <div>
                    <%# if(value.user_id.id == locals.user.id) {%>
                    <a class="btn btn-info btn-answer-del" href=/editAnswer/<%# result.id %> >Edit answer</a>
                    <a class="btn btn-danger btn-answer-del" href=/deleteAnswer/<%# result.id %> >Delete answer</a>
                    <%# } %>
                  </div>
                </div>
                
              </div>
            <%# }) %>
        <%# } %>
        </div>
      </div>
    </div>
     
    <% if (result.user_id.id == locals.user.id){ %>
    <div class="edit-delete">
      <a class="btn btn-info btn-sm" href=/editQuestion/<%= result.id %> >Edit question</a>
      <a class="btn btn-danger btn-sm" href=/deleteQuestion/<%= result.id %> >Delete question</a>
    </div>
    <% } %>
  </div>
  <%- include("./components/footer.ejs") %>

</body>
</html>